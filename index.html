<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SHRBRK | Gaming Duo & Community</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- TEMEL DEĞİŞKENLER VE TASARIM SİSTEMİ --- */
        :root {
            --bg-color: #0d1117; 
            --bg-gradient: radial-gradient(circle at center, #1a1f29 0%, #0d1117 100%);
            --panel-bg: rgba(20, 25, 35, 0.95);
            --content-panel-bg: rgba(15, 20, 30, 0.98);
            --text-primary: #f0e6d2; 
            --text-secondary: #aaa;
            --val-red: #ff4655;
            --val-dark: #1f2326;
            --val-white: #ece8e1;
            --cyber-blue: #00ffff;
            --cyber-glow: 0 0 10px rgba(0, 255, 255, 0.5);
            --border-color: rgba(255, 255, 255, 0.1);
            --font-head: 'Orbitron', sans-serif;
            --font-body: 'Rajdhani', sans-serif;
        }

        [data-theme="light"] {
            --bg-color: #f0f0f0; 
            --bg-gradient: radial-gradient(circle at center, #ffffff 0%, #f0f0f0 100%);
            --text-primary: #1a1a1a;
            --text-secondary: #555;
            --val-red: #5A189A; 
            --val-dark: #cccccc;
            --val-white: #0a0a0a;
            --cyber-blue: #5A189A;
        }

        * { box-sizing: border-box; }
        
        body {
            margin: 0; padding: 0;
            background-color: var(--bg-color);
            background-image: var(--bg-gradient);
            color: var(--text-primary);
            font-family: var(--font-body);
            overflow: hidden; 
            height: 100vh;
            transition: background 0.5s, color 0.5s;
        }

        /* --- ARKA PLAN EFEKTLERİ --- */
        #parallax-bg {
            position: fixed; top: -10%; left: -10%; width: 120%; height: 120%;
            background: url('https://images.unsplash.com/photo-1546443046-ed1ce6ffd1e9?auto=format&fit=crop&w=2070&q=80') center/cover;
            opacity: 0.08; pointer-events: none; z-index: 0; filter: blur(1px);
        }

        #cursor-glow {
            position: fixed; width: 250px; height: 250px; border-radius: 50%;
            pointer-events: none; background: radial-gradient(circle, rgba(255,70,85,0.15) 0%, transparent 60%);
            mix-blend-mode: screen; z-index: 2000; filter: blur(20px); opacity: 0;
            transition: opacity 0.3s;
        }
        body:hover #cursor-glow { opacity: 1; }

        /* --- AUTH & HEADER STYLES (GÜNCELLENDİ) --- */
        .header-container {
            position: fixed; top: 0; left: 0; width: 100%; padding-top: 15px; z-index: 3000;
            display: flex; flex-direction: column; align-items: center; justify-content: center; pointer-events: none;
        }
        .header-container > * { pointer-events: auto; }

        .logo {
            font-family: var(--font-head); font-size: 3.5rem; font-weight: 900; letter-spacing: 8px; margin: 0;
            color: var(--val-white); text-shadow: 0 0 20px rgba(255, 70, 85, 0.5); cursor: pointer; transition: transform 0.3s;
        }
        .logo:hover { transform: scale(1.05); }

        .hero-links { display: flex; gap: 10px; margin-top: 25px; }
        
        .hero-link {
            text-decoration: none; color: var(--text-secondary); font-family: var(--font-head); font-size: 0.75rem;
            padding: 8px 0; width: 140px; text-align: center;
            backdrop-filter: blur(25px); background: rgba(255, 255, 255, 0.08); border: 1px solid rgba(255,255,255,0.12);
            clip-path: polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);
            transition: 0.3s;
        }
        .hero-link:hover { background: var(--val-red); color: var(--val-white); transform: translateY(-2px); }

        .top-controls {
            position: absolute; right: 40px; top: 30px; display: flex; gap: 10px; align-items: center;
        }

        .control-btn {
            background: transparent; border: 1px solid var(--border-color); color: var(--text-primary);
            padding: 8px 15px; cursor: pointer; font-family: var(--font-head); font-size: 0.7rem;
            display: flex; align-items: center; gap: 8px; transition: 0.3s;
            backdrop-filter: blur(25px); background: rgba(255, 255, 255, 0.08);
            clip-path: polygon(10px 0, 100% 0, 100% 100%, 0 100%, 0 10px);
        }
        .control-btn:hover { background: var(--val-white); color: #000; }
        
        .auth-btn { border-color: var(--cyber-blue); color: var(--cyber-blue); }
        .auth-btn:hover { background: var(--cyber-blue); color: #000; }

        /* --- LOBBY CARDS --- */
        .main-container { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; align-items: center; justify-content: center; z-index: 10; padding-top: 20px; pointer-events: none; 
        }
        .lobby-grid {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;
            width: 70vw; max-width: 1000px; height: 60vh; pointer-events: auto;
        }
        
        .lobby-card {
            position: relative; cursor: pointer; transition: 0.3s;
            display: flex; flex-direction: column; 
            clip-path: polygon(0 0, 100% 0, 100% 85%, 85% 100%, 0 100%);
            background: rgba(31, 35, 38, 0.8); backdrop-filter: blur(25px);
            border: 1px solid rgba(255,255,255,0.12); overflow: hidden;
            min-height: 200px;
        }
        .lobby-card:hover { transform: translateY(-10px); border-color: var(--val-red); box-shadow: 0 0 30px rgba(255, 70, 85, 0.2); z-index: 100; }

        .card-bg {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-size: cover; background-position: center; transition: 0.4s;
            filter: grayscale(80%) brightness(0.6);
        }
        .c1 .card-bg { background-image: url('https://cmsassets.rgpub.io/sanity/images/dsfx7636/news/e435c3378b7999a3338b408dbb5da8ba63f91150-616x822.png?accountingTag=VAL?auto=format&fit=fill&q=80&w=352'); }
        .c2 .card-bg { background-image: url('https://cmsassets.rgpub.io/sanity/images/dsfx7636/news/477284dfe402a85abcf6b07512bcd6f01c8fe60e-616x822.png?accountingTag=VAL?auto=format&fit=fill&q=80&w=352'); }
        .c3 .card-bg { background-image: url('https://cmsassets.rgpub.io/sanity/images/dsfx7636/news/14145d7bf9be17afa80c04ee4fbe200076cc1769-616x822.png?accountingTag=VAL?auto=format&fit=fill&q=80&w=352'); }
        .c4 .card-bg { background-image: url('https://cmsassets.rgpub.io/sanity/images/dsfx7636/news/7cb513c9b3eae3286449776e85753138436d553c-616x822.png?accountingTag=VAL?auto=format&fit=fill&q=80&w=352'); }
        .c5 .card-bg { background-image: url('https://cmsassets.rgpub.io/sanity/images/dsfx7636/news/47387e354c34d51b84066bc47af3c5755b92b9c5-616x822.png?accountingTag=VAL?auto=format&fit=fill&q=80&w=352'); }
        .c6 .card-bg { background-image: url('https://images.unsplash.com/photo-1542751371-adc38448a05e?ixlib=rb-4.0.3&auto=format&fit=crop&w=1170&q=80'); }

        .lobby-card:hover .card-bg { filter: grayscale(0%); transform: scale(1.1); }
        .lobby-card:hover .status-bar { background: var(--val-red); color: white; }

        .card-content { position: absolute; bottom: 20%; width: 100%; z-index: 2; }
        .status-bar {
            background: rgba(255, 255, 255, 0.9); color: #000; padding: 8px 0; text-align: center;
            font-family: var(--font-head); font-weight: 900; width: 90%; margin: 0 auto;
            clip-path: polygon(0 0, 100% 0, 95% 100%, 5% 100%); transition: 0.3s;
        }

        /* --- CONTENT MODALS --- */
        .content-section {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.9);
            width: 80%; height: 80%; opacity: 0; pointer-events: none; display: none;
            background: rgba(15, 20, 30, 0.95); backdrop-filter: blur(30px);
            border: 1px solid var(--cyber-blue); z-index: 3000; transition: 0.4s;
            flex-direction: column; align-items: center; overflow: hidden;
        }
        .content-section.active { opacity: 1; pointer-events: auto; display: flex; transform: translate(-50%, -50%) scale(1); }

        .standard-content { padding: 40px; text-align: center; width: 100%; overflow-y: auto; }
        
        .back-btn {
            margin-top: 20px; padding: 10px 30px; background: rgba(0,255,255,0.2); color: var(--val-white);
            font-family: var(--font-head); cursor: pointer; border: 1px solid rgba(0,255,255,0.3);
            clip-path: polygon(10px 0, 100% 0, 100% 100%, 0 100%, 0 10px); transition: 0.3s;
        }
        .back-btn:hover { background: var(--val-red); border-color: var(--val-red); }

        /* --- AUTH MODALS (LOGIN/REGISTER) --- */
        .auth-modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); z-index: 5000; display: none;
            justify-content: center; align-items: center;
        }
        .auth-box {
            background: rgba(20, 25, 35, 0.95); padding: 40px; width: 400px;
            border: 1px solid var(--cyber-blue); box-shadow: 0 0 30px rgba(0,255,255,0.2);
            text-align: center; position: relative;
            clip-path: polygon(20px 0, 100% 0, 100% calc(100% - 20px), calc(100% - 20px) 100%, 0 100%, 0 20px);
        }
        .auth-input {
            width: 100%; padding: 12px; margin: 10px 0; background: rgba(0,0,0,0.5);
            border: 1px solid #444; color: #fff; font-family: var(--font-body);
        }
        .auth-input:focus { border-color: var(--cyber-blue); outline: none; }
        
        .auth-submit {
            width: 100%; padding: 12px; margin-top: 20px; background: var(--cyber-blue);
            color: #000; border: none; font-family: var(--font-head); font-weight: bold; cursor: pointer;
        }
        .auth-submit:hover { background: #fff; }
        
        .close-auth { position: absolute; top: 10px; right: 15px; color: #fff; cursor: pointer; }

        /* --- YENİ FORUM DÜZENİ (SIDEBARLI) --- */
        .forum-layout { display: flex; width: 100%; height: 100%; }
        
        /* SOL MENU */
        .forum-sidebar {
            width: 260px; background: rgba(0,0,0,0.4); border-right: 1px solid rgba(255,255,255,0.1);
            display: flex; flex-direction: column; padding: 20px 0;
        }
        .forum-cat-btn {
            padding: 15px 25px; color: var(--text-secondary); cursor: pointer; text-align: left;
            transition: 0.3s; display: flex; align-items: center; gap: 10px;
            font-family: var(--font-head); letter-spacing: 1px; border-left: 3px solid transparent;
        }
        .forum-cat-btn:hover, .forum-cat-btn.active {
            background: rgba(255,255,255,0.05); color: var(--val-white); border-left-color: var(--cyber-blue);
        }
        
        /* SAĞ CHAT ALANI */
        .forum-main { flex: 1; display: flex; flex-direction: column; position: relative; background: rgba(0,0,0,0.2); }
        .forum-header {
            padding: 20px; border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex; justify-content: space-between; align-items: center; background: rgba(0,0,0,0.3);
        }
        .chat-area { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 15px; }
        
        .message-card {
            background: rgba(255,255,255,0.05); padding: 15px;
            border-left: 2px solid var(--val-red); border-radius: 0 10px 10px 10px;
            max-width: 80%; animation: slideIn 0.3s ease;
        }
        .msg-header { display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 0.8rem; color: var(--cyber-blue); font-family: var(--font-head); }
        .msg-body { color: var(--text-primary); line-height: 1.4; }
        .msg-time { font-size: 0.7rem; color: #555; text-align: right; margin-top: 5px; }
        
        .input-area {
            padding: 20px; background: rgba(0,0,0,0.5); border-top: 1px solid rgba(255,255,255,0.1);
            display: flex; gap: 10px; align-items: center;
        }
        .chat-input { flex: 1; background: transparent; border: none; border-bottom: 1px solid var(--text-secondary); color: var(--val-white); padding: 10px; outline: none; }
        .send-btn { padding: 10px 25px; background: var(--val-red); color: white; border: none; font-family: var(--font-head); cursor: pointer; clip-path: polygon(10px 0, 100% 0, 100% 100%, 0 100%, 0 10px); }

        @keyframes slideIn { from { opacity: 0; transform: translateX(-10px); } to { opacity: 1; transform: translateX(0); } }
        .game-blur { filter: blur(5px); }

        /* Hacker text vb. diğer efektler korundu */
    </style>
</head>
<body onload="startLobbyEntrance()">

    <div id="parallax-bg"></div>
    <div id="cursor-glow"></div>

    <div class="header-container blur-target" id="headerRef">
        <h1 class="logo" onclick="showLobby()">SHRBRK</h1>
        <div class="hero-links">
            <a href="https://www.tiktok.com/@shrbrktw" class="hero-link">TIKTOK</a>
            <a href="https://kick.com/shrbrk" class="hero-link">KICK</a>
            <a href="https://instagram.com/shrbrkofficial" class="hero-link">INSTAGRAM</a>
            <a href="https://youtube.com/@SHRBRK" class="hero-link">YOUTUBE</a>
        </div>
        
        <div class="top-controls">
            <div id="auth-buttons-container" style="display:flex; gap:10px;">
                <button class="control-btn auth-btn" onclick="openAuthModal('login')">GİRİŞ YAP</button>
                <button class="control-btn auth-btn" onclick="openAuthModal('register')">KAYIT OL</button>
            </div>
            <div id="user-profile-container" style="display:none; gap:10px; align-items:center;">
                <span id="display-username" style="font-family:var(--font-head); font-size:0.8rem; color:var(--cyber-blue);">USER</span>
                <button class="control-btn" onclick="logoutUser()">ÇIKIŞ</button>
            </div>

            <button class="control-btn" id="themeBtn" onclick="toggleTheme()">
                <i class="fas fa-adjust"></i> MOD
            </button>
        </div>
    </div>

    <div id="modal-login" class="auth-modal">
        <div class="auth-box">
            <span class="close-auth" onclick="closeAuthModal('login')"><i class="fas fa-times"></i></span>
            <h2 style="color:var(--cyber-blue); font-family:var(--font-head);">GİRİŞ YAP</h2>
            <input type="email" id="login-email" class="auth-input" placeholder="E-Posta Adresi">
            <input type="password" id="login-pass" class="auth-input" placeholder="Şifre">
            <button class="auth-submit" onclick="loginWithEmail()">GİRİŞ YAP</button>
            <button class="auth-submit" style="background:#fff; color:#333; margin-top:10px;" onclick="loginWithGoogle()"><i class="fab fa-google"></i> GOOGLE İLE GİRİŞ</button>
        </div>
    </div>

    <div id="modal-register" class="auth-modal">
        <div class="auth-box">
            <span class="close-auth" onclick="closeAuthModal('register')"><i class="fas fa-times"></i></span>
            <h2 style="color:var(--val-red); font-family:var(--font-head);">KAYIT OL</h2>
            <input type="text" id="reg-name" class="auth-input" placeholder="Kullanıcı Adı">
            <input type="email" id="reg-email" class="auth-input" placeholder="E-Posta Adresi">
            <input type="password" id="reg-pass" class="auth-input" placeholder="Şifre (Min 6 Karakter)">
            <button class="auth-submit" style="background:var(--val-red); color:#fff;" onclick="registerWithEmail()">KAYIT OL</button>
        </div>
    </div>

    <div class="main-container blur-target" id="mainContainer">
        <div id="lobby" class="lobby-grid">
            <div class="lobby-card c1" onclick="openPage('page-yayinlar')"><div class="card-bg"></div><div class="card-content"><div class="status-bar">YAYINLAR</div></div></div>
            <div class="lobby-card c2" onclick="openPage('page-oyunlar')"><div class="card-bg"></div><div class="card-content"><div class="status-bar">OYUNLAR</div></div></div>
            <div class="lobby-card c3" onclick="openPage('page-hakkinda')"><div class="card-bg"></div><div class="card-content"><div class="status-bar">HAKKIMIZDA</div></div></div>
            <div class="lobby-card c4" onclick="openPage('page-ekipman')"><div class="card-bg"></div><div class="card-content"><div class="status-bar">EKİPMAN</div></div></div>
            <div class="lobby-card c5" onclick="openPage('page-iletisim')"><div class="card-bg"></div><div class="card-content"><div class="status-bar">İLETİŞİM</div></div></div>
            
            <div class="lobby-card c6" onclick="openPage('page-forum')">
                <div class="card-bg"></div>
                <div class="card-content"><div class="status-bar" style="color:var(--cyber-blue);">FORUM</div><div class="card-sub-text">TOPLULUK</div></div>
            </div>
        </div>

        <div id="page-yayinlar" class="content-section">
            <div class="standard-content">
                <h2 style="font-family:var(--font-head); color:var(--cyber-blue);">YAYIN PROGRAMI</h2>
                <p>Haftalık yayın takvimi burada.</p>
                <button class="back-btn" onclick="showLobby()">LOBİYE DÖN</button>
            </div>
        </div>
        <div id="page-oyunlar" class="content-section"><div class="standard-content"><h2>OYUNLAR</h2><button class="back-btn" onclick="showLobby()">GERİ</button></div></div>
        <div id="page-hakkinda" class="content-section"><div class="standard-content"><h2>BİZ KİMİZ?</h2><button class="back-btn" onclick="showLobby()">GERİ</button></div></div>
        <div id="page-ekipman" class="content-section"><div class="standard-content"><h2>EKİPMANLAR</h2><button class="back-btn" onclick="showLobby()">GERİ</button></div></div>
        <div id="page-iletisim" class="content-section"><div class="standard-content"><h2>İLETİŞİM</h2><button class="back-btn" onclick="showLobby()">GERİ</button></div></div>

        <div id="page-forum" class="content-section" style="padding:0; align-items:stretch;">
            <div class="forum-layout">
                <div class="forum-sidebar">
                    <div style="padding:0 20px 20px 20px; font-family:var(--font-head); color:var(--val-red); font-size:1.2rem;">KATEGORİLER</div>
                    <div class="forum-cat-btn active" onclick="switchCategory('ekip', this)"><i class="fas fa-users"></i> Ekip Sohbeti</div>
                    <div class="forum-cat-btn" onclick="switchCategory('oyun', this)"><i class="fas fa-gamepad"></i> Oyun Genel</div>
                    <div class="forum-cat-btn" onclick="switchCategory('big5', this)"><i class="fas fa-hand-paper"></i> Big 5</div>
                    <div class="forum-cat-btn" onclick="switchCategory('valorant', this)"><i class="fas fa-crosshairs"></i> Valorant</div>
                    
                    <div style="margin-top:auto; padding:20px;">
                         <button class="back-btn" style="width:100%; margin:0;" onclick="showLobby()">ÇIKIŞ</button>
                    </div>
                </div>

                <div class="forum-main">
                    <div class="forum-header">
                        <h3 id="forum-title" style="margin:0; font-family:var(--font-head); color:var(--cyber-blue);">EKİP SOHBETİ</h3>
                        <span style="font-size:0.8rem; color:var(--text-secondary);">SHRBRK Community</span>
                    </div>

                    <div id="chat-messages" class="chat-area">
                        <div style="text-align:center; color:#555; margin-top:50px;">Yükleniyor...</div>
                    </div>

                    <div class="input-area">
                        <div id="guest-warning" style="width:100%; text-align:center; color:#aaa; font-size:0.9rem;">
                            Sohbete katılmak için lütfen sağ üstten <span style="color:var(--val-red); cursor:pointer;" onclick="openAuthModal('login')">GİRİŞ YAPIN</span>
                        </div>
                        <div id="member-input" style="display:none; width:100%; gap:10px; display:flex;">
                            <input type="text" id="msg-input" class="chat-input" placeholder="Mesajını yaz..." autocomplete="off">
                            <button class="send-btn" onclick="sendMessage()">GÖNDER</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
        import { getDatabase, ref, push, onValue, query, limitToLast } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-database.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, createUserWithEmailAndPassword, signInWithEmailAndPassword, updateProfile, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAcPdBegs8lszoK-RIgOqQvVzXIgw8GcfE",
            authDomain: "shrbrkinfo-chat.firebaseapp.com",
            projectId: "shrbrkinfo-chat",
            storageBucket: "shrbrkinfo-chat.firebasestorage.app",
            messagingSenderId: "517040954066",
            appId: "1:517040954066:web:b1ad2c4cf4ac1ea6ff6b0b",
            databaseURL: "https://shrbrkinfo-chat-default-rtdb.europe-west1.firebasedatabase.app/"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const auth = getAuth(app);
        const googleProvider = new GoogleAuthProvider();

        let currentCategory = 'ekip';
        let currentUser = null;

        // --- AUTH FONKSİYONLARI ---
        window.openAuthModal = (type) => {
            document.getElementById('modal-' + type).style.display = 'flex';
        }
        window.closeAuthModal = (type) => {
            document.getElementById('modal-' + type).style.display = 'none';
        }

        // Kayıt Ol (Email)
        window.registerWithEmail = async () => {
            const name = document.getElementById('reg-name').value;
            const email = document.getElementById('reg-email').value;
            const pass = document.getElementById('reg-pass').value;

            if(!name || !email || !pass) { alert("Lütfen tüm alanları doldurun!"); return; }

            try {
                const userCredential = await createUserWithEmailAndPassword(auth, email, pass);
                // Kullanıcı adını güncelle
                await updateProfile(userCredential.user, { displayName: name });
                alert("Kayıt Başarılı! Hoşgeldin " + name);
                closeAuthModal('register');
            } catch (error) {
                alert("Hata: " + error.message);
            }
        };

        // Giriş Yap (Email)
        window.loginWithEmail = async () => {
            const email = document.getElementById('login-email').value;
            const pass = document.getElementById('login-pass').value;

            try {
                await signInWithEmailAndPassword(auth, email, pass);
                closeAuthModal('login');
            } catch (error) {
                alert("Giriş Hatası: " + error.message);
            }
        };

        // Giriş Yap (Google)
        window.loginWithGoogle = () => {
            signInWithPopup(auth, googleProvider)
                .then(() => closeAuthModal('login'))
                .catch((err) => alert("Hata: " + err.message));
        };

        // Çıkış Yap
        window.logoutUser = () => signOut(auth);

        // Kullanıcı Durum Takibi
        onAuthStateChanged(auth, (user) => {
            currentUser = user;
            const btns = document.getElementById('auth-buttons-container');
            const profile = document.getElementById('user-profile-container');
            const guestWarn = document.getElementById('guest-warning');
            const memberInput = document.getElementById('member-input');

            if (user) {
                // Giriş Yapılmış
                btns.style.display = 'none';
                profile.style.display = 'flex';
                document.getElementById('display-username').innerText = user.displayName || user.email;
                
                guestWarn.style.display = 'none';
                memberInput.style.display = 'flex';
            } else {
                // Misafir
                btns.style.display = 'flex';
                profile.style.display = 'none';
                
                guestWarn.style.display = 'block';
                memberInput.style.display = 'none';
            }
        });

        // --- FORUM FONKSİYONLARI ---
        window.switchCategory = function(cat, btn) {
            document.querySelectorAll('.forum-cat-btn').forEach(el => el.classList.remove('active'));
            btn.classList.add('active');
            
            const titles = { 'ekip': 'EKİP SOHBETİ', 'oyun': 'OYUN GENEL', 'big5': 'BIG 5 TARTIŞMA', 'valorant': 'VALORANT TAKTİKLERİ' };
            document.getElementById('forum-title').innerText = titles[cat];
            currentCategory = cat;
            loadMessages();
        }

        window.sendMessage = function() {
            if (!currentUser) return;
            const input = document.getElementById('msg-input');
            const msg = input.value;
            if (msg.trim() === "") return;

            const chatRef = ref(db, 'forumlar/' + currentCategory);
            push(chatRef, {
                uid: currentUser.uid,
                kullanici: currentUser.displayName || "Anonim",
                mesaj: msg,
                zaman: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})
            });
            input.value = "";
        }

        function loadMessages() {
            const area = document.getElementById('chat-messages');
            area.innerHTML = '<div style="text-align:center; color:#555;">Yükleniyor...</div>';
            
            const chatRef = query(ref(db, 'forumlar/' + currentCategory), limitToLast(50));
            onValue(chatRef, (snapshot) => {
                area.innerHTML = "";
                const data = snapshot.val();
                if(data) {
                    Object.values(data).forEach(item => {
                        const isMe = currentUser && item.uid === currentUser.uid;
                        const div = document.createElement('div');
                        div.className = 'message-card';
                        if(isMe) div.style.borderColor = 'var(--cyber-blue)';
                        div.innerHTML = `
                            <div class="msg-header" style="${isMe ? 'color:var(--cyber-blue)' : ''}">${item.kullanici}</div>
                            <div class="msg-body">${item.mesaj}</div>
                            <div class="msg-time">${item.zaman}</div>
                        `;
                        area.appendChild(div);
                    });
                    area.scrollTop = area.scrollHeight;
                } else {
                    area.innerHTML = '<div style="text-align:center; color:#555; margin-top:20px;">Henüz mesaj yok.</div>';
                }
            });
        }

        // Klavye Enter
        document.getElementById('msg-input').addEventListener('keypress', (e) => {
            if(e.key === 'Enter') sendMessage();
        });

        loadMessages();
    </script>

    <script>
        // --- ANİMASYON VE UI GEÇİŞLERİ (MEVCUT) ---
        function startLobbyEntrance() {
            const cards = document.querySelectorAll('.lobby-card');
            cards.forEach((c, i) => {
                c.style.opacity = 0; c.style.transform = `translateY(60px) scale(0.9)`;
                setTimeout(() => { c.style.opacity = 1; c.style.transform = "translateY(0) scale(1)"; }, i * 100);
            });
        }

        function openPage(id) {
            document.getElementById('lobby').style.opacity = '0';
            document.getElementById('lobby').style.pointerEvents = 'none';
            document.getElementById('headerRef').classList.add('game-blur');
            setTimeout(() => { document.getElementById(id).classList.add('active'); }, 300);
        }

        function showLobby() {
            document.querySelectorAll('.content-section').forEach(el => el.classList.remove('active'));
            document.getElementById('headerRef').classList.remove('game-blur');
            setTimeout(() => { 
                document.getElementById('lobby').style.opacity = '1'; 
                document.getElementById('lobby').style.pointerEvents = 'auto';
            }, 300);
        }

        let isLight = false;
        function toggleTheme() {
            isLight = !isLight;
            if(isLight) {
                document.documentElement.setAttribute('data-theme', 'light');
                document.getElementById('themeBtn').innerHTML = '<i class="fas fa-moon"></i> KOYU';
            } else {
                document.documentElement.removeAttribute('data-theme');
                document.getElementById('themeBtn').innerHTML = '<i class="fas fa-adjust"></i> MOD';
            }
        }
        
        // Mouse efekti
        document.addEventListener('mousemove', (e) => {
            const x = (e.clientX / window.innerWidth - 0.5) * 20;
            const y = (e.clientY / window.innerHeight - 0.5) * 20;
            document.getElementById('parallax-bg').style.transform = `translate(${x}px, ${y}px)`;
            document.getElementById('cursor-glow').style.transform = `translate(${e.clientX - 125}px, ${e.clientY - 125}px)`;
        });
    </script>
</body>
</html>
